<?xml version="1.0" encoding="UTF-8"?>
<BatchCalcJobDefinition xmlns="http://soap.sforce.com/2006/04/metadata">
    <dataSpaceApiName>default</dataSpaceApiName>
    <datasources>
        <fields>
            <alias>Membership_Number</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>Membership_Number</name>
        </fields>
        <fields>
            <alias>Points</alias>
            <dataType>Numeric</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>Points</name>
        </fields>
        <fields>
            <alias>VoucherDefinitionName</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>VoucherDefinitionName</name>
        </fields>
        <label>CSVupload</label>
        <name>CSVupload</name>
        <sourceName>Test_Bulk_Upload_2_Vouchers</sourceName>
        <type>Analytics</type>
    </datasources>
    <datasources>
        <fields>
            <alias>Id</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>Id</name>
        </fields>
        <fields>
            <alias>Name</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>Name</name>
        </fields>
        <label>JournalType</label>
        <name>JournalType</name>
        <sourceName>JournalType</sourceName>
        <type>StandardObject</type>
    </datasources>
    <datasources>
        <fields>
            <alias>Id</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>Id</name>
        </fields>
        <fields>
            <alias>MembershipNumber</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>MembershipNumber</name>
        </fields>
        <fields>
            <alias>MemberStatus</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>MemberStatus</name>
        </fields>
        <fields>
            <alias>ProgramId</alias>
            <dataType>Text</dataType>
            <isPrimaryKey>false</isPrimaryKey>
            <name>ProgramId</name>
        </fields>
        <label>LoyaltyProgramMember</label>
        <name>LoyaltyProgramMember</name>
        <sourceName>LoyaltyProgramMember</sourceName>
        <type>StandardObject</type>
    </datasources>
    <executionPlatformType>CRMA</executionPlatformType>
    <filters>
        <criteria>
            <operator>Equals</operator>
            <sequence>1</sequence>
            <sourceFieldName>Name</sourceFieldName>
            <value>Manual Points Adjustment</value>
        </criteria>
        <filterCondition>1</filterCondition>
        <isDynamicFilter>false</isDynamicFilter>
        <label>FilterJournalType</label>
        <name>FilterJournalType</name>
        <sourceName>JournalType</sourceName>
    </filters>
    <isTemplate>false</isTemplate>
    <joins>
        <fields>
            <alias>AcvitityDate</alias>
            <sourceFieldName>AcvitityDate</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>Channel</alias>
            <sourceFieldName>Channel</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>JournalDate</alias>
            <sourceFieldName>JournalDate</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>JournalTypeId</alias>
            <sourceFieldName>Id</sourceFieldName>
            <sourceName>FilterJournalType</sourceName>
        </fields>
        <fields>
            <alias>JournalTypeName</alias>
            <sourceFieldName>JournalTypeName</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>MemberId</alias>
            <sourceFieldName>MemberId</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>MembershipNumber</alias>
            <sourceFieldName>MembershipNumber</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>Membership_Number</alias>
            <sourceFieldName>Membership_Number</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>MemberStatus</alias>
            <sourceFieldName>MemberStatus</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>Name</alias>
            <sourceFieldName>Name</sourceFieldName>
            <sourceName>FilterJournalType</sourceName>
        </fields>
        <fields>
            <alias>Points</alias>
            <sourceFieldName>Points</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>ProgramId</alias>
            <sourceFieldName>ProgramId</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>Status</alias>
            <sourceFieldName>Status</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <fields>
            <alias>VoucherDefinitionName</alias>
            <sourceFieldName>VoucherDefinitionName</sourceFieldName>
            <sourceName>AddFields</sourceName>
        </fields>
        <joinKeys>
            <primarySourceFieldName>JournalTypeName</primarySourceFieldName>
            <secondarySourceFieldName>Name</secondarySourceFieldName>
        </joinKeys>
        <label>JournalTypeJoin</label>
        <name>JournalTypeJoin</name>
        <primarySourceName>AddFields</primarySourceName>
        <secondarySourceName>FilterJournalType</secondarySourceName>
        <type>Inner</type>
    </joins>
    <joins>
        <fields>
            <alias>MemberId</alias>
            <sourceFieldName>Id</sourceFieldName>
            <sourceName>LoyaltyProgramMember</sourceName>
        </fields>
        <fields>
            <alias>MembershipNumber</alias>
            <sourceFieldName>MembershipNumber</sourceFieldName>
            <sourceName>LoyaltyProgramMember</sourceName>
        </fields>
        <fields>
            <alias>Membership_Number</alias>
            <sourceFieldName>Membership_Number</sourceFieldName>
            <sourceName>CSVupload</sourceName>
        </fields>
        <fields>
            <alias>MemberStatus</alias>
            <sourceFieldName>MemberStatus</sourceFieldName>
            <sourceName>LoyaltyProgramMember</sourceName>
        </fields>
        <fields>
            <alias>Points</alias>
            <sourceFieldName>Points</sourceFieldName>
            <sourceName>CSVupload</sourceName>
        </fields>
        <fields>
            <alias>ProgramId</alias>
            <sourceFieldName>ProgramId</sourceFieldName>
            <sourceName>LoyaltyProgramMember</sourceName>
        </fields>
        <fields>
            <alias>VoucherDefinitionName</alias>
            <sourceFieldName>VoucherDefinitionName</sourceFieldName>
            <sourceName>CSVupload</sourceName>
        </fields>
        <joinKeys>
            <primarySourceFieldName>Membership_Number</primarySourceFieldName>
            <secondarySourceFieldName>MembershipNumber</secondarySourceFieldName>
        </joinKeys>
        <label>ProgramMemberJoin</label>
        <name>ProgramMemberJoin</name>
        <primarySourceName>CSVupload</primarySourceName>
        <secondarySourceName>LoyaltyProgramMember</secondarySourceName>
        <type>Inner</type>
    </joins>
    <label>Create Bulk Manual Points Adjustments</label>
    <processType>Loyalty</processType>
    <status>Active</status>
    <transforms>
        <expressionFields>
            <alias>AcvitityDate</alias>
            <dataType>DateTime</dataType>
            <expression>NOW()</expression>
        </expressionFields>
        <expressionFields>
            <alias>Channel</alias>
            <dataType>Text</dataType>
            <expression>SUBSTITUTE({MemberStatus}  , &quot;Active&quot;, &quot;Web&quot; )</expression>
            <length>18</length>
        </expressionFields>
        <expressionFields>
            <alias>JournalDate</alias>
            <dataType>DateTime</dataType>
            <expression>NOW()</expression>
        </expressionFields>
        <expressionFields>
            <alias>JournalTypeName</alias>
            <dataType>Text</dataType>
            <expression>SUBSTITUTE({MemberStatus}  , &quot;Active&quot;, &quot;Manual Points Adjustment&quot;)</expression>
            <length>255</length>
        </expressionFields>
        <expressionFields>
            <alias>Status</alias>
            <dataType>Text</dataType>
            <expression>SUBSTITUTE({MemberStatus}  , &quot;Active&quot;, &quot;Processed&quot; )</expression>
            <length>18</length>
        </expressionFields>
        <label>AddFields</label>
        <name>AddFields</name>
        <sourceName>ProgramMemberJoin</sourceName>
        <transformationType>Expression</transformationType>
    </transforms>
    <writebacks>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>AcvitityDate</sourceFieldName>
            <targetFieldName>ActivityDate</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>JournalDate</sourceFieldName>
            <targetFieldName>JournalDate</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>JournalTypeId</sourceFieldName>
            <targetFieldName>JournalTypeId</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>MemberId</sourceFieldName>
            <targetFieldName>MemberId</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>Status</sourceFieldName>
            <targetFieldName>Status</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>ProgramId</sourceFieldName>
            <targetFieldName>LoyaltyProgramId</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>Points</sourceFieldName>
            <targetFieldName>TransactionAmount</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>Channel</sourceFieldName>
            <targetFieldName>Channel</targetFieldName>
        </fields>
        <fields>
            <runtimeParameter>false</runtimeParameter>
            <sourceFieldName>VoucherDefinitionName</sourceFieldName>
            <targetFieldName>Voucher_Definition_Name__c</targetFieldName>
        </fields>
        <isChangedRow>false</isChangedRow>
        <label>TJWriteBack</label>
        <name>TJWriteBack</name>
        <operationType>Insert</operationType>
        <sourceName>JournalTypeJoin</sourceName>
        <storageType>sObject</storageType>
        <targetObjectName>TransactionJournal</targetObjectName>
        <writebackSequence>1</writebackSequence>
        <writebackUser>005Hp00000hfFcWIAU</writebackUser>
    </writebacks>
</BatchCalcJobDefinition>
